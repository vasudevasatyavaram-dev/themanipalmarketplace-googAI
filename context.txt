Here you will write everything. All context, plan, and blueprint will be written here without exception

**Temporary Change: Dashboard Preview Mode**

**Overview:**
Temporarily disabled the login page to provide a direct preview of the seller dashboard. This is achieved by using a mock user session, allowing for immediate access to the dashboard's features and UI without needing to authenticate. This change is for development and preview purposes only and should be reverted for production.

---

**Feature: Mobile-Friendly Header Navigation**

**Overview:**
To enhance the user experience on mobile devices, the header has been redesigned to be less cluttered. The individual buttons for "Profile," "Best Practices," and "Logout" have been consolidated into a single main menu, accessible via a standard "hamburger" icon (three horizontal bars).

**Behavior:**
1.  **Menu Button:** A new menu icon is located in the top-right corner of the header.
2.  **Opening the Menu:** Tapping or clicking this icon reveals a dropdown menu.
3.  **Menu Options:** The dropdown menu contains the following options, each with a corresponding icon for clarity:
    *   **Dashboard:** Navigates the user back to the main dashboard view.
    *   **Profile:** Opens the profile settings modal.
    *   **Best Practices:** Navigates to the best practices guide.
    *   **Logout:** Signs the user out of the application.
4.  **Closing the Menu:** The menu can be closed by either tapping the menu icon again or by tapping anywhere outside of the menu area.
5.  **Responsive Design:** This change primarily benefits mobile users by saving screen real estate but provides a clean and consistent navigation experience across all screen sizes. The user's email/phone number, previously visible on larger screens, is now also accessible within this menu to maintain a clean header layout.

**Visual Appearance:**
*   The menu icon is styled to match the existing UI elements.
*   The dropdown menu appears directly below the menu icon, with a `brand-cream` background, a subtle border, and a drop shadow to make it stand out from the content below.
*   Menu items have a hover effect to provide visual feedback to the user.

This change streamlines navigation and aligns the dashboard with modern, mobile-first design principles.

---

**Feature: Enhanced Image Cropping Modal**

**Overview:**
To improve the usability of the image cropper, especially for large portrait-oriented images, the cropping modal has been significantly enlarged. Previously, tall images would be scaled down to fit, making it difficult to see the full picture for precise cropping.

**Behavior & Visuals:**
1.  **Increased Modal Size:** The modal window is now wider (from `max-w-lg` to `max-w-3xl`), providing a larger canvas for the cropping tool.
2.  **Taller Image Preview:** The maximum height for the image preview has been increased from `50vh` to `70vh` (70% of the screen's height). This ensures that even tall portrait images are fully visible, allowing sellers to easily and accurately select their desired crop.
3.  **Responsive Design:** The modal remains fully responsive and will adapt to smaller screen sizes appropriately.

This change provides a much better user experience for editing product images, leading to better-quality product photos on the marketplace.

---

**UI Tweak: Reorder Image Crop Aspect Ratios**

**Overview:**
To improve the workflow for sellers, the order of the aspect ratio presets in the image cropping modal has been adjusted. The "Auto" (freeform) option is now listed first, giving users immediate access to the most flexible cropping method, while "Square" is still maintained as the default selection upon opening the modal.

**Behavior:**
1.  **New Preset Order:** The buttons for aspect ratio selection now appear in the following order: **Auto, Square, Portrait, Landscape**.
2.  **Default Aspect Ratio:** The initial crop selection remains **Square (1:1)**, as this is the recommended format for consistency. The "Square" button is highlighted by default when the modal opens.
3.  **Functionality:** Clicking on any of the preset buttons changes the aspect ratio of the crop selection as it did before.

This minor adjustment enhances user experience by making the most flexible cropping option more prominent and accessible.

---

**UI Fix: Immediate Aspect Ratio Update in Image Cropper**

**Overview:**
A fix has been implemented in the image cropping modal to address a usability issue. Previously, when a user selected a new aspect ratio preset (e.g., "Portrait," "Landscape"), the cropping rectangle would not visually update to the new shape until the user manually interacted with it.

**Behavior Change:**
1.  **Immediate Visual Feedback:** Now, upon clicking an aspect ratio button, the cropping selection immediately and automatically reshapes itself to match the selected aspect ratio (e.g., clicking "Landscape" instantly changes the crop to a 16:9 rectangle).
2.  **Centered Crop:** The new crop is centered on the image and maintains a size of 90% of the image's dimensions, providing a sensible default that the user can then fine-tune.

This fix makes the cropping tool more intuitive and responsive, improving the overall user experience during the product listing process.

---

**UI Change: Reorder Product Forms for Better Workflow**

**Overview:**
To improve the user workflow when adding or editing a product, the fields in both the "Add New Product" and "Edit Product" modals have been reordered. The current layout required sellers to handle images first, which can interrupt the flow of entering product details.

**Behavior Change:**
The image management section (including the drag-and-drop area and image previews) has been moved from the top of the form to the bottom. This allows sellers to first fill out or update all the textual details of their product (Title, Description, Price, etc.) and then manage the image uploads as the final step.

**New Form Order (for both Add & Edit Modals):**
1.  Product Title
2.  Product Description
3.  Categories & Type
4.  Price & Quantity
5.  **Product Images** (drag-and-drop area and previews)

This change creates a more logical and linear process for listing and editing products, enhancing usability and providing a consistent experience across the dashboard.

---

**UI Fix: Robust Image Preview for All Aspect Ratios**

**Overview:**
An issue in the product forms has been fixed where image previews, particularly for landscape-oriented images, did not display correctly. They sometimes appeared stretched or improperly scaled instead of being "letterboxed" within their square containers.

**Behavior Change:**
1.  **Universal Aspect Ratio Support:** The image preview container styling has been made more robust. It now correctly displays images of *any* aspect ratio (portrait, landscape, square, or custom).
2.  **Correct Scaling and Centering:** By wrapping the image in a flexbox container, it is guaranteed to be perfectly centered both horizontally and vertically. It is scaled down to fit entirely within the square preview box while maintaining its true aspect ratio.
3.  **Visible Background:** The empty space around the image (pillarboxing for tall images, letterboxing for wide images) now correctly shows the container's white background, providing an accurate and clean preview of the final cropped image.

This change ensures that sellers see an exact representation of their cropped images, regardless of the shape, providing confidence in how their product will be displayed on the marketplace.

---

**UI/UX Improvement: Reposition Image Preview Delete Button**

**Overview:**
To improve usability and prevent accidental deletions, the delete button on the image previews within the "Add Product" and "Edit Product" forms has been repositioned.

**Behavior Change:**
1.  **New Position:** The delete button, which appears when a user hovers over an image preview, is no longer in the center. It is now located in the **top-right corner**, a more standard and less intrusive position.
2.  **Visual Style:** The button now has a semi-transparent background, ensuring the 'delete' icon is clearly visible regardless of the image content. The hover effect has been retained to provide clear feedback.
3.  **Consistency:** This change is applied to all image previews in both the "Add Product" and "Edit Product" modals for a consistent user experience.

This change makes the image management process safer and more user-friendly by reducing the risk of frustrating mistakes.

---

**Feature: Re-Croppable Image Previews**

**Overview:**
A significant enhancement has been made to the image upload workflow. Previously, once a crop was applied to an image, it was final. Now, sellers have the ability to go back and adjust the crop of any uploaded image directly from the thumbnail preview before submitting the form.

**Behavior Change:**
1.  **"Edit Crop" Button:** Each image thumbnail in the "Add Product" and "Edit Product" forms now features a new "Edit Crop" icon that appears on hover, next to the delete button.
2.  **Re-Opening the Cropper:** Clicking this icon opens the Image Crop modal again, loading the *original, un-cropped image*.
3.  **Preserved Crop Settings:** The cropper will automatically be set to the user's last saved crop for that image, allowing them to make adjustments from where they left off instead of starting over.
4.  **Underlying Data Management:** To make this possible, the application now temporarily stores the original image file in the browser's memory, alongside the specific crop settings. The final, cropped image is only generated and uploaded to Supabase upon final submission of the product form.

This feature provides a more forgiving and powerful image editing experience, ensuring sellers can perfect their product photos with ease.

---

**UI/UX Tweak: Optimized Image Action Button Placement**

**Overview:**
To enhance mobile usability and create a more intuitive interface, the placement of the action buttons on image previews has been refined.

**Behavior Change:**
1.  **Centered Primary Action:** The "Edit Crop" button now appears directly in the center of the image thumbnail on hover. This makes it the primary, most easily accessible action, especially on touch devices.
2.  **Cornered Secondary Action:** The "Delete" button has been moved to the top-right corner of the thumbnail. This is a conventional and safe placement for a destructive action, significantly reducing the chance of accidental taps.
3.  **Consistency:** This new, more intuitive layout is applied to all image previews in both the "Add Product" and "Edit Product" forms.

This separation of actions provides a cleaner, more organized, and safer user experience.

---

**UI Fix: Perfect Re-Crop State Restoration**

**Overview:**
To create a more reliable and seamless re-cropping experience, the underlying logic of the Image Crop modal has been refactore. Instead of deriving the crop mode by calculating aspect ratios (which could lead to floating-point errors), the system now explicitly stores the user's selected mode (e.g., 'auto', 'square', 'portrait') in the application's state.

**Behavior Change:**
1.  **Direct State Storage:** When a crop is applied, both the crop coordinates and the selected mode are saved.
2.  **Perfect State Restoration:** When a user clicks "Edit Crop," the modal now uses this saved mode to instantly and accurately highlight the correct aspect ratio button and restore the exact crop, completely eliminating the previous guesswork and potential for errors.

This change ensures the re-cropping feature is not only more efficient but also perfectly reliable, correctly preserving the user's intent and providing a frustration-free editing experience.

---

**UI Tweak: "Auto" Crop Mode Improvement**

**Overview:**
To enhance the usability of the image cropper, the behavior of the "Auto" aspect ratio mode has been refined.

**Behavior Change:**
1.  **Square Default for "Auto":** When a user clicks the "Auto" button, the cropping selection now immediately defaults to a centered square shape.
2.  **Immediate Free-form Resizing:** After this initial square is set, the aspect ratio lock is released, and the user can immediately resize the crop to any dimension they wish, as is expected from an "Auto" mode.

This change provides a more predictable and intuitive starting point for free-form cropping, improving the overall user experience.

---

**Authentication Flow Re-enabled**

**Overview:**
The temporary "preview mode," which used a mock user session to bypass the login screen, has been reverted. The application's original, production-ready authentication flow has been restored.

**Behavior Change:**
1.  **Login Required:** Users will now be presented with the login/sign-up page upon visiting the application.
2.  **Supabase Authentication:** The app now communicates with Supabase Authentication to manage user sessions. It will fetch the current session on load and listen for any changes in authentication state (e.g., login, logout).
3.  **Secure Access:** The seller dashboard is now protected and can only be accessed by authenticated users.

This change moves the application from a development preview state to a production-ready state with a fully functional and secure authentication system.

---

**Feature: Rental Session Field**

**Overview:**
To support product rentals, a new "Session" field has been added. This field allows sellers to specify the duration or unit for which a rental price applies (e.g., "per night," "per hour").

**Behavior & UI Changes:**
1.  **Conditional Field:** In both the "Add Product" and "Edit Product" forms, a new text input for "Rental Session" will now appear. This field is only visible when the product "Type" is set to "Rent."
2.  **Required for Rentals:** This field is mandatory for all rental listings.
3.  **Product Card Display:** On the main dashboard, the product cards for rental items will now display the price along with its session (e.g., "Rental Price: ₹1500 / per night"), providing clear information to the seller.
4.  **Database Integration:** The session information is stored in a new `session` column in the database, which is constrained to only accept values for rental items.

This feature provides the necessary functionality for a rental marketplace while keeping the UI for standard "Buy" listings clean and uncluttered.

---

**UI Tweak: De-emphasize Product Delete Button**

**Overview:**
To improve the visual hierarchy and reduce the prominence of the destructive "Delete" action on product cards, its styling has been updated to be less conspicuous.

**Behavior & Visual Change:**
1.  **From Solid to Outline:** The "Delete" button no longer has a solid, bright red (`brand-accent`) background. It has been changed to a more subtle "outline" style.
2.  **New Styling:** The button now has a transparent background with a `brand-accent` colored border and text. On hover, the background fills with the `brand-accent` color, and the text turns white, providing clear feedback without being overly dominant in its resting state.

This change makes the "Edit" button the most visually neutral action, while the "Delete" button is clearly marked as a secondary, more dangerous option.

---

**Feature: Image Carousel on Product Cards**

**Overview:**
To improve the product viewing experience on the main dashboard, an image carousel has been added to the product cards. Sellers can now cycle through all uploaded images for a product directly from the product list.

**Behavior & Visual Changes:**
1.  **Carousel Functionality:** For products with more than one image, the image display area on the card now functions as a carousel.
2.  **Navigation Arrows:**
    *   When hovering over the image, left and right navigation arrows will appear on the sides.
    *   Clicking these arrows allows the seller to cycle through the product's images. The carousel will loop, meaning clicking "next" on the last image will go to the first, and "previous" on the first image will go to the last.
3.  **Page Indicators:**
    *   Small dot indicators are now displayed at the bottom of the image area.
    *   These dots show the total number of images available and highlight which one is currently being viewed.

This feature is only active for products with multiple images, keeping the interface for single-image products clean and unchanged. This enhancement provides a richer, more interactive dashboard experience.

---

**UI Tweak: Display Session in Version History**

**Overview:**
To maintain consistency with the main product list, the Version History modal has been updated to display the rental session information for products listed for rent.

**Behavior & Visual Change:**
- In the details section for each version, if a product is a rental, the price will now be displayed along with its session (e.g., "Rental Price: ₹1500 / per night"). This ensures that sellers have a complete view of their product's history, including rental terms.

---

**UI/UX Improvement: Refine Product Card Actions**

**Overview:**
To create a clearer and more intuitive workflow for sellers, the action buttons ("Edit," "History," "Delete") on the product cards have been updated. The "Edit" and "History" buttons are now hidden for approved products, and the layout will dynamically adjust to the number of visible buttons.

**Behavior & Visual Changes:**
1.  **Hide Buttons for Approved Products:** The "Edit" and "History" buttons are no longer visible on product cards where the `approval_status` is 'approved'. This clarifies that approved listings are live and cannot be directly modified.
2.  **Enable Editing for Rejected Products:** Sellers can now click "Edit" on a rejected product. This allows them to correct any issues based on rejection feedback and resubmit the product for approval.
3.  **Dynamic Button Layout:** The button container now uses a flexible layout, so the buttons automatically and evenly share the available space. This ensures the layout always looks balanced and professional, whether one, two, or three buttons are visible.

---
**UI/UX Improvement: Rejected Product Workflow**

**Overview:**
To improve the seller's experience when dealing with rejected products, several UI and functional refinements have been made. These changes provide clearer instructions and prevent users from reverting to a known problematic state.

**Behavior & Visual Changes:**
1.  **"Resubmit" Button:** On the main product list, the action button for a rejected product, which was previously labeled "Edit," has been renamed to **"Resubmit."** This makes the intended action much clearer to the user. The functionality remains the same—it opens the edit modal, allowing the seller to make corrections and submit a new version.
2.  **Version History Refinement:** In the "Version History" modal:
    *   Any version that was rejected is now visually de-emphasized with a reduced opacity ("dulled out").
    *   A "Rejected" status badge has been added next to the version number for clarity.
    *   The **"Revert to this version"** button is now disabled for any rejected version. This prevents sellers from accidentally reverting their product to a state that has already failed the approval process.

---
**UI/UX Improvement: Highlight Approved Products**

**Overview:**
To provide sellers with clear and satisfying visual confirmation that their product is live, the styling of approved product cards has been updated to make them stand out.

**Behavior & Visual Changes:**
1.  **"Live" Badge:** A new, prominent badge is now displayed in the top-left corner of the product image for all approved items. This vibrant green badge features a checkmark icon and the text "Live," instantly communicating the product's status.
2.  **Enhanced Border:** The entire product card for an approved item now has a subtle but distinct green border, further distinguishing it from other products.
3.  **Elevated Shadow:** The card is given a slightly more pronounced, permanent box-shadow, making it appear "lifted" and more important on the page, while still enhancing on hover.

These changes make it easy for sellers to scan their dashboard and identify which products are active on the marketplace, providing positive reinforcement and improving clarity.
---
**Feature: Editing Live (Approved) Products**

**Overview:**
The product editing workflow has been updated to allow sellers to submit edits for their live, approved products. When an approved product is edited, the live version remains visible on the marketplace, while the new edit is submitted for approval. This ensures there is no downtime for the seller's listing.

**Behavior & Visual Changes:**
1.  **"Edit" Button on Approved Products:** The "Edit" button is now visible on all approved product cards. Clicking it opens the edit modal, pre-filled with the live product's data.
2.  **Dashboard Display Logic:** Your dashboard will now always display the **live, approved version** of a product if one exists. Any pending edits you've submitted will not replace the live version on your main dashboard view.
3.  **"History" Button for Unapproved Edits:** A "History" button will now appear on your approved product cards *only if* you have a newer version that is pending approval or has been rejected. This button is your gateway to viewing and managing those unapproved edits.
4.  **Backend Functionality:** The core database function `get_latest_products_for_user` has been updated to prioritize showing the approved version, ensuring your dashboard reflects what customers see. A secondary function, `get_groups_with_unapproved_edits`, has been created to efficiently check which of your products have unapproved edits.
5.  **Reverting:** The revert functionality in the Version History modal works as before. You can revert to the approved version, which will delete any newer, unapproved edits.

---
**UI Tweak: Clarify Version History Highlighting**

**Overview:**
To improve clarity in the Version History modal, the UI has been updated to visually distinguish both the live, approved version and the chronologically latest version of a product.

**Behavior & Visual Change:**
1.  **Highlight Approved Version:** The container for the approved version is now highlighted with a distinct green border and a light green background.
2.  **"Live" Badge:** A "Live" badge is displayed next to the version number of the approved item.
3.  **Consistent "Latest" Tag:** The "(Latest)" tag is now **always** displayed on the version with the highest edit count (the most recent one), regardless of its approval status. This means a single version can be marked as both "Live" and "(Latest)" if the approved version is the most recent, or they can be two separate versions.

---
**UI Refinement: Finalized Version History View**

**Overview:**
The Version History modal has been finalized to provide maximum clarity to sellers. This update ensures that both the live (approved) version and the chronologically latest version are always clearly and distinctly identified.

**Behavior & Visual Changes:**
1.  **Approved Version Highlighting:** The approved version is consistently highlighted with a green border and background, and labeled with a "Live" badge.
2.  **Latest Version Tag:** The version with the highest `edit_count` is now always marked with a "(Latest)" tag, regardless of its approval status. This provides an unambiguous chronological reference point for the seller.
---
**Feature: Enhanced Feedback for Live Product Edits**

**Overview:**
To improve clarity for sellers managing live products, the UI has been updated to provide better feedback on the status of their submitted edits, both on the main dashboard and within the version history.

**Behavior & Visual Changes:**
1.  **"Pending Edit" Indicator:** On the main product list, if a live, approved product has a newer version awaiting approval, a new **"Pending Edit"** status chip will appear next to the "Approved" status. This provides an immediate visual cue that a change is under review without altering the main "Approved" status.
2.  **Rejection Reasons in History:** In the "Version History" modal, any version that was rejected will now display an information icon. Hovering over this icon will reveal a tooltip containing the `reject_explanation`, identical to the feature on the main product cards. This allows sellers to easily review the reasons for rejection for any past edits.
3.  **Backend Enhancement:** A database function was upgraded to return not just that an unapproved edit exists, but also its specific status ('pending' or 'rejected'), allowing the UI to be more intelligent.
---
**Feature: Refined Feedback for Rejected Edits**

**Overview:**
To provide sellers with the clearest possible feedback, the UI for handling rejected product edits has been improved across the dashboard. This includes adding a specific status indicator for rejected edits on live products and ensuring all rejection feedback is prominent and accessible.

**Behavior & Visual Changes:**
1.  **"Edit Rejected" Indicator:** On the main product list, if a live, approved product has a newer, rejected edit, a new **"Edit Rejected"** status chip appears. This chip is accompanied by an info icon that shows the rejection reason in a tooltip on hover.
2.  **Improved Tooltip Visibility:** In the Version History modal, the z-index of the rejection reason tooltip has been increased to `z-40`, ensuring it always appears in front of other UI elements.
3.  **Selective Opacity:** For all rejected products (both on the main list and in the history), the "Rejected" status chip and its associated info icon are no longer faded out. Only the non-essential product information is de-emphasized, making critical feedback and available actions clearly visible.
4.  **Consistent History View:** This prominent, non-faded display of rejection reasons is applied to every rejected version within the Version History modal, regardless of the parent product's overall status.
---
**UI Tweak: Ensure Visibility of Rejection Feedback**

**Overview:**
A final UI refinement has been made to the Version History modal to ensure that critical feedback for rejected versions is always clear and prominent. Previously, the "Rejected" badge and its info tooltip were incorrectly faded out along with the rest of the version's details.

**Behavior & Visual Change:**
*   In the Version History modal, the "Rejected" badge and the info icon (with its tooltip explaining the rejection reason) are now **always displayed at full opacity**.
*   The non-essential details of the rejected version (like the title, description, and price) remain de-emphasized to communicate the status, but the feedback itself is now clearly visible.
---
**UI Fix: Correct Tooltip Positioning in Version History**

**Overview:**
A fix has been implemented to correct a visual bug in the Version History modal where the tooltip explaining a rejection reason could be partially hidden or clipped by the modal's header.

**Behavior & Visual Change:**
*   The tooltip now appears **below** the information icon instead of above it. This ensures that it always has enough space to be fully visible within the scrollable content area, regardless of the version's position in the list.
---
**Audit: Security & Logic Hardening**

**Overview:**
A comprehensive audit of the application's security and versioning logic was performed to ensure the system is robust and production-ready. This involved adding a critical security layer and fixing two subtle logical flaws.

**Implementation Details:**
1.  **Security Hardening (RLS):** The application has been hardened with **Row Level Security (RLS)** policies on both the `products` database table and the `product_images` storage bucket. This is a best-practice, defense-in-depth measure that ensures users can *only* ever access or modify their own data, regardless of how they access the backend. The necessary SQL and Storage policies have been documented for application.
2.  **Logic Fix 1 (Orphaned Image Cleanup):** The "Revert" function in the Version History modal has been fixed. It now correctly identifies and deletes any "orphaned" images from Supabase Storage that belong exclusively to the abandoned product versions, preventing storage bloat and unnecessary costs.
3.  **Logic Fix 2 (Save Button Logic):** The change-detection logic in the Edit modal has been fixed. It now correctly identifies when images are swapped (e.g., one is removed and a different one is added), ensuring the "Save as New Version" button becomes enabled as expected.

---
**Audit: Final Security & Logic Hardening**

**Overview:**
A final, rigorous audit was performed to harden the application against sophisticated threats and logical edge cases. This audit identified and fixed a critical security vulnerability, a data integrity flaw, and a minor UI layout issue.

**Implementation Details:**
1.  **Critical Security Fix (RPC Functions):** The database functions (`get_latest_products_for_user`, `get_groups_with_unapproved_edits`) have been hardened. They now ignore the user ID sent from the client and instead use the secure, server-side `auth.uid()` function. This makes it impossible for a user to request data that does not belong to them, preventing a major data leakage vulnerability.
2.  **Critical Data Integrity Fix (Race Conditions):** A `UNIQUE` constraint has been added to the `products` table on the combination of `(product_group_id, edit_count)`. This is a powerful database rule that makes it physically impossible to have two versions with the same number for the same product, completely eliminating potential race conditions from users editing in multiple tabs.
3.  **UI Polish (Title Truncation):** Product titles on the main dashboard cards and in the Version History modal header are now truncated with an ellipsis (...) if they are too long. This proactively prevents long titles from breaking the UI layout.

---
**Audit: Final Security & Logic Audit**

**Overview:**
A final, paranoid audit was performed to harden the application against the most obscure edge cases and potential security threats. This audit identified and fixed a critical data integrity vulnerability related to versioning, a security risk in file handling, and a minor UI feedback issue.

**Implementation Details:**
1.  **Critical Data Integrity Fix (Version Hijacking):** A database trigger (`check_sequential_edit_count`) has been implemented. This powerful server-side rule runs before any new product version is inserted and ensures that the `edit_count` is strictly sequential (i.e., exactly one greater than the previous maximum). This makes it impossible for a user to "jump" versions (e.g., from Version 0 to 999), protecting the integrity of the version history and preventing exploits.
2.  **Security Fix (File Path Hardening):** The method for generating file paths in Supabase Storage has been hardened. Instead of using the user-provided product title, which could be manipulated, image paths are now constructed using a secure, random UUID (e.g., `userId/{random_uuid}/{fileName}`). This decouples file paths from user input, making them unpredictable and immune to manipulation or file name collision attacks.
3.  **UI Polish (Improved Error Feedback):** The error handling in the product submission modals has been improved. Instead of showing a generic "An unexpected error occurred" message, the system now provides more specific feedback, distinguishing between an "Image upload failed" and a "Failed to save product details." This gives the user clearer information if something goes wrong.

---
**Feature: Help & Support Reporting**

**Overview:**
A new "Help & Support" feature has been added, allowing sellers to easily submit queries or report problems directly from their dashboard. This provides a clear communication channel and helps in addressing user issues efficiently.

**Behavior & Visual Changes:**
1.  **Menu Integration:** A new "Help & Support" option, accompanied by a question mark icon, has been added to the main dropdown menu in the header.
2.  **Reporting Modal:** Clicking this option opens a dedicated "Help & Support" modal.
3.  **Submission Form:** The modal contains a simple form with an optional "Subject" field and a mandatory "Message" field.
4.  **Submission Logic:** Upon submission, the form content is saved to a new `report_query` table, linked to the user. A confirmation notification appears on the dashboard.

**Recommended Security (RLS):**
It is highly recommended to apply RLS policies to the new `report_query` table to ensure users can only access their own submissions.
```sql
ALTER TABLE public.report_query ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Allow individual insert access"
ON public.report_query FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Allow individual read access"
ON public.report_query FOR SELECT
USING (auth.uid() = user_id);
```


---
Edited Placeholdertext (BY VASU)
---



---
**Refactor: Shared Product Form Component**

**Overview:**
To reduce code duplication and improve maintainability, the forms within the "Add Product" and "Edit Product" modals have been refactored. The shared UI elements of the form have been extracted into a new, reusable component called `ProductFormFields`.

**Implementation Details:**
1.  **New `ProductFormFields` Component:** A new component, `components/dashboard/ProductFormFields.tsx`, has been created. This component is responsible for rendering the entire form UI, including text inputs, dropdowns, and the complex image uploader. It is designed to be stateless and receives all necessary data and event handlers as props from its parent.
2.  **`AddProductModal` Refactor:** This modal now uses the `ProductFormFields` component to render its form. It retains all of its own state management and submission logic but delegates the UI rendering, significantly reducing its JSX footprint.
3.  **`EditProductModal` Refactor:** Similarly, this modal now uses `ProductFormFields`. It passes down additional props specific to editing, such as the list of existing images, and the new component handles the logic to display both existing and newly added images.
4.  **Centralized Types:** To support the new component, shared type definitions for image data (`CroppedImage`, `ExistingImage`) have been moved to the central `types.ts` file.

This refactoring makes the codebase cleaner and more modular. Any future changes to the product form's UI now only need to be made in one place (`ProductFormFields.tsx`), ensuring consistency across both the "add" and "edit" experiences.
---
**UI Tweak: Enhance Login Page Title**

**Overview:**
To improve the visual hierarchy and branding on the login page, the main title has been made larger and more visually prominent, while ensuring it remains responsive on mobile devices.

**Behavior & Visual Changes:**
1.  **Increased Font Size:** The title's font size has been increased to `text-2xl` (24px) on mobile and to 28px on larger screens for better visibility.
2.  **Visual Accent:** The dots (`•`) on either side of the title have been colored with the brand's accent color, making the title "pop" and reinforcing the brand identity.
3.  **Responsive Spacing:** The letter spacing has been adjusted to be normal on mobile to accommodate the larger font size on one line, and wider on larger screens where there is more space.
---
**UI Tweak: Compact Analytics Lock Screen**

**Overview:**
To improve the dashboard's appearance for new sellers, the "locked" state of the analytics section has been redesigned to be significantly more compact and space-efficient.

**Behavior & Visual Changes:**
1.  **Compact Placeholder:** The previous, large blurred placeholder has been replaced with a single, smaller container that features an abstract, blurred representation of charts.
2.  **Reduced Height:** This change drastically reduces the vertical space taken up by the component, making the dashboard feel less empty for users who have not yet made a sale.
3.  **Resized Content:** The lock icon and text in the overlay have been resized to better fit the new, smaller layout, creating a cleaner and more professional look.
---
**Feature: Add Product Wizard**

**Overview:**
To make listing an item less intimidating, the "Add Product" modal has been transformed into a guided, two-step wizard. The "Edit Product" modal remains a single form for efficiency.

**Behavior & Visual Changes:**
1.  **Two-Step Process:** The new product flow is broken into two simple steps:
    *   **Step 1: The Basics:** Captures Title, Description, Price, and Quantity.
    *   **Step 2: Details & Visuals:** Handles the "Buy/Rent" type, conditional "Rental Session," Categories, and image uploads.
2.  **Progress Indicator:** A clear progress bar at the top of the modal shows the user which step they are on, reducing cognitive load.
3.  **Guided Navigation:** "Next" and "Back" buttons allow for easy navigation. The form performs validation at each step. This approach presents a manageable number of fields at a time, making the form feel quick and easy to complete on a small screen.
---
**Auth Flow: Branding & Best Practices**

**Overview:**
To improve branding on the Google OAuth screen, the underlying cause has been identified and a code-level best practice has been implemented.

**Explanation:**
The "continue to [supabase_url]" text on the Google sign-in page is a security feature from Google that shows the official `Site URL` configured in the Supabase project. The permanent solution is to set a custom domain in the Supabase dashboard settings, which is an infrastructure change.

**Code Improvement:**
As a related best practice, the `signInWithOAuth` function in `Login.tsx` has been updated to include a `redirectTo` option, set to `window.location.origin`. This explicitly tells Supabase where to send the user after a successful login, making the authentication flow more robust and ready for a future custom domain.
---
**Auth Flow: Hardcoded Redirect URL**

**Overview:**
The Google OAuth `redirectTo` URL has been updated from the dynamic `window.location.origin` to a static, hardcoded URL as requested.

**Implementation:**
The `redirectTo` option in the `signInWithOAuth` function in `Login.tsx` is now set to `'http://themanipalmarketplace-seller.vercel.app'`. This ensures that all users are redirected to this specific URL after Google authentication, regardless of the environment they are logging in from.
